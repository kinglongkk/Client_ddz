{"version":3,"sources":["../../../../../assets/script/ui/assets/script/ui/ddz_UIGameHelp.js"],"names":["app","require","cc","Class","extends","subGameName","properties","content","Node","scroll_Right","ScrollView","OnCreateInit","curShowViewName","allGameHelpConfig","GetTableDict","ConfigList","key","push","OnShow","ShowGameRule","ruleStr","stopAutoScroll","removeAllChildren","i","length","gameName","img","CreateImg","desc","reg","replace","fontSize","colorList","fontColor","split","ErrLog","id","color","Color","CreateLabel","isTitle","UpdateContent","scrollToTop","str","index","node","name","dataIndex","curLabel","addComponent","Label","horizontalAlign","HorizontalAlign","LEFT","overflow","Overflow","RESIZE_HEIGHT","cacheMode","CacheMode","CHAR","lineHeight","anchorX","x","width","enableWrapText","isSystemFontUsed","string","y","addChild","path","self","Sprite","CreateLoadPromise","SpriteFrame","then","spriteFrame","curSprite","getComponent","catch","error","destroy","stack","childs","children","needHeight","height","zIndex","sortAllChildren","OnClick","btnName","btnNode"],"mappings":"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","file":"ddz_UIGameHelp.js","sourceRoot":"../../../../../assets/script/ui","sourcesContent":["var app = require(\"ddz_app\");\r\ncc.Class({\r\n    extends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n    properties: {\r\n        content:cc.Node,\r\n        scroll_Right:cc.ScrollView,\r\n    },\r\n    OnCreateInit: function () {\r\n        this.curShowViewName = \"\";\r\n        let allGameHelpConfig = app[app.subGameName + \"_SysDataManager\"]().GetTableDict(\"GameHelp\");\r\n        this.ConfigList = [];\r\n        for(let key in allGameHelpConfig){\r\n            this.ConfigList.push(allGameHelpConfig[key]);\r\n        }\r\n    },\r\n\r\n    OnShow:function () {\r\n\r\n        this.ShowGameRule(app.subGameName);\r\n    },\r\n\r\n    ShowGameRule:function(ruleStr){\r\n        this.scroll_Right.stopAutoScroll();\r\n        if(ruleStr == this.curShowViewName){\r\n            return;\r\n        }\r\n        this.content.removeAllChildren();\r\n        this.curShowViewName = ruleStr;\r\n\r\n        for(let i=0;i<this.ConfigList.length;i++){\r\n            if(this.ConfigList[i].gameName == this.curShowViewName){\r\n                if(this.ConfigList[i].img != \"null\"){\r\n                    this.CreateImg(this.ConfigList[i].img,i);\r\n                }\r\n                else{\r\n                    let desc = this.ConfigList[i].desc;\r\n                    let reg = /\\/n/g;\r\n                    desc = desc.replace(reg, \"\\n\");\r\n                    reg = /\\/t/g;\r\n                    desc = desc.replace(reg, \"\\t\");\r\n                    let fontSize = this.ConfigList[i].fontSize;\r\n                    let colorList = this.ConfigList[i].fontColor.split(\",\");\r\n                    if(colorList.length != 4){\r\n                        this.ErrLog(\"GameHelp Config color error id is :\" + this.ConfigList[i].id);\r\n                        continue;\r\n                    }\r\n                    let color = new cc.Color(colorList[0],colorList[1],colorList[2],colorList[3]);\r\n                    this.CreateLabel(desc,fontSize,color,this.ConfigList[i].isTitle,i);\r\n                }\r\n            }\r\n        }\r\n        this.UpdateContent();\r\n        this.scroll_Right.scrollToTop();\r\n    },\r\n\r\n    CreateLabel:function(str,fontSize,color,isTitle,index){\r\n        let node = new cc.Node();\r\n        node.name = \"label\" + index;\r\n        node.dataIndex = index;\r\n        let curLabel = node.addComponent(cc.Label);\r\n        curLabel.fontSize = fontSize;\r\n        curLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n        curLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;\r\n        curLabel.cacheMode = cc.Label.CacheMode.CHAR;\r\n        if(isTitle)\r\n            curLabel.lineHeight = 60;\r\n        else\r\n            curLabel.lineHeight = 40;\r\n        node.anchorX = 0;\r\n        node.x = -(this.content.width/2);\r\n        node.width = this.content.width;\r\n        curLabel.enableWrapText = true;\r\n        curLabel.isSystemFontUsed = true;\r\n        curLabel.string = str;\r\n        node.color = color;\r\n        node.y = node.y - 200;\r\n        this.content.addChild(node);\r\n    },\r\n    CreateImg:function(path,index){\r\n        let self = this;\r\n        let node = new cc.Node();\r\n        node.name = \"img\" + index;\r\n        node.dataIndex = index;\r\n        node.addComponent(cc.Sprite);\r\n        node.anchorX = 0;\r\n        node.x = -(this.content.width/2);\r\n        app[app.subGameName + \"_ControlManager\"]().CreateLoadPromise(path, cc.SpriteFrame)\r\n            .then(function(spriteFrame){\r\n                if(!spriteFrame){\r\n                    self.ErrLog(\"gameHelp CreateImg(%s) load spriteFrame fail\", path);\r\n                    return\r\n                }\r\n                let curSprite = node.getComponent(cc.Sprite);\r\n                curSprite.spriteFrame = spriteFrame;\r\n                self.content.addChild(node);\r\n                self.UpdateContent();\r\n            })\r\n            .catch(function(error){\r\n                node.destroy();\r\n                self.ErrLog(\"gameHelp CreateImg(%s) error:%s\", path, error.stack);\r\n            })\r\n    },\r\n    UpdateContent:function(){\r\n        let childs = this.content.children;\r\n        if(0==childs.length)return;\r\n        //childs.sort(this.sortChild);//creator自己排序不会去刷新ui得设置下zIndex在sortAllChildren\r\n        let needHeight = 0;\r\n        for(let i=0;i<childs.length;i++){\r\n            needHeight += childs[i].height;\r\n            childs[i].zIndex = childs[i].dataIndex;\r\n        }\r\n        this.content.height = needHeight + 50;\r\n        this.content.sortAllChildren();\r\n        this.scroll_Right.scrollToTop();\r\n    },\r\n    //---------点击函数---------------------\r\n    OnClick:function(btnName, btnNode){\r\n    },\r\n\r\n});\r\n"]}